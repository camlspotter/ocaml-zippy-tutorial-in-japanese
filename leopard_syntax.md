# OCamlã®æ–‡æ³•ã¨ã‹

è«–æ–‡ã˜ã‚ƒãªã„ã®ã§ã ã‚‰ã ã‚‰ã¨æ›¸ãã¾ã™ã‚“ã§ã€ãƒã‚¤ãƒ³ãƒˆã ã‘ã§ã‚‚ç°¡æ½”ã«:

* OCamlã®æ–‡æ³•ã®åˆå¿ƒè€…æ®ºã—ã¯ä¸»ã«ã€Œçµ‚ç«¯ã®é–‹ã„ãŸæ–‡æ³•ã€ã«ã‚ˆã‚‹ã‚‚ã®
* ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ã®æ–‡æ³•ã¯é–‹ã„ã¦ã„ã‚‹ã‚ˆã†ã§è‡³ã‚‹ã¨ã“ã‚é–‰ã˜ã¦ã„ã‚‹
* OCamlã®æ–‡æ³•ã«ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ã‚’å…¥ã‚Œã¦ã¿ã¾ã—ãŸ
* è¨€èªžã«é™ã‚‰ãšå¾Œæ–¹äº’æ›è£½ã‚’ä¿ã£ãŸã¾ã¾ã€ç°¡å˜ã«ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ã‚’å…¥ã‚Œã‚‰ã‚Œã‚‹æ–¹æ³•
* å®Ÿè£…ã‚ã‚‹ã‚ˆ

# OCamleopard

ã“ã®æ•°å¹´ã€ç§ã®ä½™æš‡ã®OCamléŠã³ã¯ä¸»ã«PPXã‚’ã„ã˜ã‚‹ã“ã¨ã ã£ãŸã®ã§ã™ãŒã€
PPXã¯æ‰‹è»½ã§ã™ãŒé™ç•ŒãŒã‚ã£ã¦ã€æ€ã„ã¤ã„ãŸã‚¢ã‚¤ãƒ‡ã‚¢ãŒPPXã ã‘ã§ã¯é›£ã—ã‹ã£ãŸã‚Šã€
å®Ÿè£…ã§ããªã‹ã£ãŸã‚Šã—ã¾ã—ãŸã€‚

ãã“ã§ã€ä»Šå¹´ã‹ã‚‰ã€ã¾ãŸOCamlã‚³ãƒ³ãƒ‘ã‚¤ãƒ©æœ¬ä½“ã‚’ç´°ã€…ã¨ã„ã˜ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã¯ OCamleopard (å’Œåã¯ã€Œå¤§éº’éºŸ(ãŠãŠãã‚Šã‚“)ã€)ã€‚

ç´¹ä»‹ã™ã‚‹ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ã¯æ•°å¹´å‰ã«OCaml 4.02.1ã§ã¾ãšå®Ÿè£…ã—ãŸã‚‚ã®ã§ã€
ãã‚Œã‚’å¼•ã£å¼µã‚Šå‡ºã—ã¦ãã¦OCaml 4.05.0ã®æ”¹é€ ã§ã‚ã‚‹OCamleopard 4.05.0ã«é©ç”¨ã€
ãã‚Œã‹ã‚‰OCaml4.06.0ãŒå‡ºã¦ã—ã¾ã£ãŸã®ã§OCamleopard 4.06.0ã«ãƒãƒ¼ãƒˆã—ãŸã‚‚ã®ã§ã™ã€‚

OCamleopardã«ã¯ã€ã“ã‚“ãªã®ãŒOCamlã«ã‚ã£ãŸã‚‰ã„ã„ãªã¨è¨€ã†ã‚‚ã®ã§
ã‚ã‚Šã¨æ¥½ã«å®Ÿè£…ã§ãã‚‹ãŒã€å¤šåˆ†æœ¬å®¶ã«ã¯å…¥ã‚‰ãªã„ã ã‚ã†ãªã€ã¨ã„ã†ã‚‚ã®ã‚’
æ€ã„ã¤ã„ã¦ã¯ã¡ã¾ã¡ã¾ã¨å®Ÿè£…ã—ã¦ã„ã‚‹ã®ã§ã™ãŒã€
ãã®ç´¹ä»‹ã¯ã¾ãŸåˆ¥ã®æ©Ÿä¼šã«ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚

# ReasonãŒæµè¡Œã£ã¦ã„ã‚‹ã‚ˆã†ã§ã™

ç§ã€"OCaml"ã®Twitteræ¤œç´¢ã‚¿ãƒ–ã‚’ä½œã£ã¦è©±é¡Œã‚’ç›£è¦–ã—ã¦ã„ã‚‹ã‚“ã§ã™ãŒã€
ä»Šå¹´2017å¹´ã®OCamlã‚¿ãƒ–ã§ã¯ReasonãŒã‚ã‚Šã¨æµè¡Œã£ã¦ã¾ã—ãŸã€‚
(Reasonæµè¡Œã£ã¦ãªã„ã¨ã‹è¨€ã‚ãªã„ã§ãã ã•ã„ã€‚
OCamlã®æµè¡Œã‚Šæ–¹ã¨æ¯”ã¹ã‚‹ã¨ç„¡è¦–ã§ããªã„ãã‚‰ã„æµè¡Œã£ã¦ã¾ã™)

Reasonã£ã¦ä½•ã‚„ã‚ï¼Ÿ https://reasonml.github.io/ ã«ã‚ˆã‚‹ã¨ã€

> Reasonã‚’ä½¿ã†ã¨JavaScriptã¨OCamlã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã®ã„ã„ã¨ã“ã©ã‚Šã‚’ã—ã¦
> ç°¡å˜ã«æ—©ãåž‹å®‰å…¨ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã“ã¨ãŒã§ãã¾ã™

ã ãã†ã§ã™ã€‚ä½œã£ã¦ã„ã‚‹ã®ã¯Facebookã€å¤§æ‰‹ã§ã™ã­å®‰å¿ƒæ„ŸãŒã‚ã‚Šã¾ã™ã­ã€‚
ãªã‚‹ã»ã©Googleã®è¨€èªžãŒGoãªã‚‰Facebookã®ã¯Reasonãªã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

æœ¬å½“ã®ã¨ã“ã‚Reasonã£ã¦ä½•ãªã®ã‹ã¨ã„ã†ã¨ã€

* ä¸­èº«ã¯å®Œå…¨ã«OCaml
* BuckleScriptã¨ã„ã†Bloombergã§é–‹ç™ºã•ã‚Œã¦ã„ã‚‹OCamlã®JavaScriptãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’ä½¿ã£ã¦ã„ã‚‹
* `npm`ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹äº‹ã«ã¯ã˜ã¾ã£ã¦ã€JavaScriptå‘¨ã‚Šã®ãƒ„ãƒ¼ãƒªãƒ³ã‚°ã‚’ç”¨æ„ã—ã¦ã‚ã‚‹
* OCamlã®å…ƒã®æ–‡æ³•ã¯æ¨ã¦ã¦ã€JavaScriptã®æ–‡æ³•ã«å¯„ã›ã¦ã‚ã‚‹

ã¨ã„ã†ã‚‚ã®ã§ã™ã€‚AltJSã®ä¸€ã¤ã§ã™ã‚ˆã­å¤šåˆ†ã€‚
ä¸Šè¨˜ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã«ã¯Reasonã¯è¨€èªžã§ã‚ã‚‹ã¨ã¯ä¸€è¨€ã‚‚æ›¸ã„ã¦ã‚ã‚Šã¾ã›ã‚“ã€‚
ä¸­èº«ã¯æœ¬å½“ã«OCamlã¨ä½•ã‚‚é•ã‚ãªã„ã®ã§ã€ç‹¬è‡ªè¨€èªžã¨åä¹—ã‚‹ã®ã¯æµçŸ³ã«æ°—ãŒã²ã‘ã‚‹ã®ã ã¨æ€ã„ã¾ã™ã€‚

OCamlã®æ–‡æ³•ã‚’JavaScriptã«å¯„ã›ã¦ãã®ã¾ã¾AltJSã«ã—ã¦ã—ã¾ã†ã€ã¨ã„ã†ã®ã¯ã‚¢ã‚¤ãƒ‡ã‚¢è³žã ã¨æ€ã„ã¾ã™ã€‚
éžç´”ç²‹ã€eagerã§ã€ã‚ã¾ã‚Šåž‹ã‚’æ›¸ã‹ãªã„ã§ã‚ˆã„OCamlã ã‹ã‚‰ã§ããŸäº‹ãªã®ã‹ãªã‚ã¨æ€ã„ã¾ã™ã€‚

ReasonãŒæµè¡Œã£ã¦ã„ã‚‹ã®ã‚’è¦‹ã¦ã„ã‚‹ã¨ã€æ©Ÿèƒ½ã‚„ç†è«–ã‚’ã‚ˆãçŸ¥ã‚‰ãªã„ã‹ã‚‰æ–°ã—ã„ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªžã‚’è§¦ã‚‰ãªã„ã®ã§ã¯ãªãã¦ã€å˜ã«æ–‡æ³•ãŒè‡ªåˆ†ã®æ…£ã‚Œè¦ªã—ã‚“ã§ã„ã‚‹ç‰©ã‹ã‚‰é›¢ã‚Œã¦ã„ã‚‹ã‹ã‚‰ã¨ã„ã†ç†ç”±ã§å¿Œé¿ã™ã‚‹äººãŒã‚ã‚Šã¨ã„ã‚‹ã‚“ã ãªã‚ã¨æ€ã„ã¾ã—ãŸã€‚ç§ã¯ã‚ã‚Šã¨å¤šè¨€èªžã‚’è§¦ã£ã¦ã„ã¦ã€æ©Ÿèƒ½ãŒé­…åŠ›çš„ã§ã‚ã‚Œã°æ–‡æ³•ã«å¥½ãå«Œã„ã¯ã‚ã£ã¦ã‚‚æ‹’å¦æ„Ÿã¾ã§ã¯æŒãŸãªã„ã‚ˆã†ã«ãªã£ã¦ã—ã¾ã£ã¦ã„ãŸã®ã§ã€èˆˆå‘³æ·±ãæ€ã„ã¾ã™ã€‚

ã“ã®åˆ†ã ã¨ã€OCamlã®æ–‡æ³•ã‚’Rubyã«ä¼¼ã›ã¦åå‰ã‚’å¤‰ãˆãŸã‚‰æ¡ˆå¤–ä½¿ã†äººãŒå‡ºã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã­!
(ã»ã‚“ã¾ã‹ã„ãªã€‚)

# OCamlã®æ–‡æ³•ã£ã¦ãã‚“ãªã«é†œã„ã®ï¼Ÿ

ã•ã¦ã€ã“ã®Reasonã®äº‹ãŒæœ¬é¡Œã§ã¯ãªãã¦ã€ã§ã™ã­ã€‚

ä»Šå¹´ã®OCamlã‚¿ãƒ–ã§ã¯ã“ã®Reasonã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æ§˜é”ãŒã€

> Reasonã¯OCamlã®æ–‡æ³•ã®è…ã£ãŸæ–‡æ³•ã‚’è‰¯ãã—ãŸã‚‚ã®ã§ã‚ã‚‹

ã¨ã‹

> OCamlã®æ–‡æ³•ã¯è¦‹ã‚‹ã¨ç›®ãŒæ½°ã‚Œã‚‹

ã¨ã‹è‡ªç”±ã«å‘Ÿã„ã¦ãŠã‚‰ã‚ŒãŸã®ãŒè¦³æ¸¬ã•ã‚Œã¾ã—ãŸã€‚
ã©ã†ã„ã†å®£ä¼ã‚’ã—ãŸã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼æ§˜ã¯ã“ã†ã„ã†ã“ã¨è¨€ã†ã®ã‹ãªï¼Ÿã¨æ€ã„ã¾ã™ã€‚

ãã‚“ãªã«OCamlã®æ–‡æ³•ã£ã¦é†œã„ã§ã™ã‹ã­ã€‚
OCamlã¯ç¾å½¹ã®MLå®Ÿè£…ã®ä¸­ã§æœ€ã‚‚ã‚ˆãã‚ªãƒªã‚¸ãƒŠãƒ«ã®LCF MLã®æ–‡æ³•ã‚’å®ˆã£ã¦ã„ã‚‹ã‚“ã§ã™ã‚ˆã€‚
æ®‹ã—ã¦ã„ã‚‹ã‹ã‚‰ã£ã¦ç¶ºéº—ã ã¨è¨€ã†äº‹ã§ã¯ãªã„ã‚“ã§ã™ã‘ã©ã€
`;;`ã§REPLå…¥åŠ›è©•ä¾¡ã®åŒºåˆ‡ã‚Šã«ã—ãŸã‚Šã€`2,3`ã¿ãŸã„ã«ã‚¿ãƒ—ãƒ«ã«ã‚«ãƒƒã‚³ãŒã„ã‚‰ãªã‹ã£ãŸã‚Šã€
`letrec`ãŒã‚ã£ãŸã‚Šã™ã‚‹ã®ã¯1973å¹´é ƒã‹ã‚‰ã®ä¼çµ±ãªã®ã§ã™ã€‚

ã¨ãã«`;;`ã¯ã™ããƒã‚«ã«ã•ã‚Œã‚‹ã®ã§ã™ãŒã€
ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®å®£è¨€ã®çµ‚äº†ãŒæ˜Žç¤ºã§ããªã„è¨€èªžã§ã€
REPLã§ã¯è¤‡æ•°è¡Œã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒšã—ã¦å…¥åŠ›ã—ã¦ã‚‚ãã®ã¾ã¾å‹•ãã‚‚ã®ã£ã¦ã‚ã¾ã‚Šç„¡ã„ã§ã™ã‚ˆã­ã€‚
æ”¹è¡Œã®ã¨ã“ã‚ã«`\`ã‚’å…¥ã‚Œãªãã‚ƒã„ã‘ãªã‹ã£ãŸã‚Šã€‚
MLã®æŽˆæ¥­ã§ã¯ã‚¨ãƒ‡ã‚£ã‚¿ã«æ›¸ã„ãŸè¤‡æ•°è¡Œã®ã‚³ãƒ¼ãƒ‰ã‚’REPLã«å…¥ã‚Œã¦æŒ™å‹•ã‚’ç¢ºã‹ã‚ã•ã›ãŸã‚Šã™ã‚‹ã®ã§ã€
è¤‡æ•°è¡Œã®ã‚³ãƒ¼ãƒ‰ã‚’æ”¹å¤‰ãªã—ã«ãã®ã¾ã¾å…¥åŠ›ã§ãã‚‹ã¨ã„ã†ã®ã¯é‡è¦ãªæ©Ÿèƒ½ãªã‚“ã§ã™ã€‚
ãã†ã™ã‚‹ã¨MLã®ã‚ˆã†ãªå®£è¨€çµ‚äº†ã‚’æ˜Žç¤ºã—ãªã„æ–‡æ³•ã®è¨€èªžã§ã¯ã©ã†ã—ã¦ã‚‚å®£è¨€çµ‚äº†ã®è¨˜å·ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚
ãã‚Œã«`;;`ã‚’ä½¿ã£ã¦ã„ã‚‹ã‚“ã§ã™ã­ã€‚
ãªãœ`;;`ã‹ã¨ã„ã†ã¨ã€è‹±èªžã®å¥èª­ç‚¹`:`, `;`, `,`, `.` ã‚’ä½¿ã„ãŸã„ãŒã€
å…¨ã¦å‡ºæ‰•ã£ã¦ã„ã‚‹ã‹ã‚‰ã§ã™ã€‚
ä¾‹ãˆã° `;` ã¯é€æ¬¡è©•ä¾¡ `e;e` ã«ä½¿ã‚ã‚Œã¦ã„ã‚‹ã‹ã‚‰å®£è¨€çµ‚äº†ã«ã¯ä½¿ãˆã¾ã›ã‚“ã€‚
`.` ã ã¨è‹±èªžã ã¨æ–‡ã®æœ€å¾Œã«ä½¿ã†ã‚‚ã®ã§ã™ã‹ã‚‰ã¡ã‚‡ã†ã©ã„ã„ã®ã§ã™ã‘ã‚Œã©ã€
æµ®å‹•å°æ•°ç‚¹æ•°ä»–ã«ä½¿ã£ã¦ã—ã¾ã£ã¦ã„ã¦ä½¿ãˆã¾ã›ã‚“ã€‚
(ãã®ã€Œ**ç‚¹**ã€Prologã‚„Erlangã¯é ‘å¼µã£ã¦ã¾ã™ã­ã€‚No **pun** intended.)ã€‚
ã¨ãªã‚‹ã¨å¥èª­ç‚¹ã¯å…¨ã¦ä½¿ã„åˆ‡ã£ã¦ã„ã¾ã™ã®ã§ä¸€æ–‡å­—ã§ã¯ç„¡ç†ã£ã¦ã“ã¨ã«ãªã‚Šã¾ã™ã€‚
ãã†ãªã‚‹ã¨å¼ã‚’é€æ¬¡å®Ÿè¡Œã™ã‚‹ãŸã‚ã®åŒºåˆ‡ã‚Šè¨˜å·`;`ãªã®ã§ã™ã‹ã‚‰
`;;`ã‚’é€æ¬¡å®Ÿè¡Œã•ã‚Œã‚‹å®£è¨€ã®åŒºåˆ‡ã‚Šã«ã™ã‚‹ã®ã¯ã‚ã‚Šã¨ç†ã«ã‹ãªã£ã¦ã„ã‚‹ã¨æ€ã†ã®ã§ã™ãŒã€‚

# ã„ãšã‚Œã«ã›ã‚ˆReasonã¯ç§ã«ã¯å¬‰ã—ããªã„

ã˜ã‚ƒã‚é€†ã«ç§ã«ã¨ã£ã¦Reasonã¯ã©ã†ãªã‚“ã ã€ã¨è¨€ã†ã¨ã€ã“ã‚ŒãŒå…¨ãéŸ¿ã‹ãªã„ã€‚
OCamlãƒã‚¤ãƒ†ã‚£ãƒ–ã®äººã«ã¨ã£ã¦ã¯ã€æ…£ã‚Œè¦ªã—ã‚“ã§ã„ã‚‹æ–‡æ³•ã‚’ã‚ˆãçŸ¥ã‚‰ãªã„JavaScripté¢¨ã«
å¤‰ãˆãŸã ã‘ã ã—ã€è¨€èªžæ©Ÿèƒ½ã‚‚å…¨ãåŒã˜ãªã®ã§ä½•ã®ä¾¡å€¤ã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚
JavaScriptãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¯BuckleScriptã‚‚js\_of\_ocamlã‚‚æ™®é€šã®OCamlã‹ã‚‰æ™®é€šã«
ä½¿ãˆã¾ã™ã—ã€`npm`ãªã‚“ã‹ä½¿ã‚ãªã„ã—çŸ¥ã‚‰ã‚“ã‚¬ãƒŠ...
å®Ÿéš›OCamlã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£æœ¬æµã§ReasonãŒè©±é¡Œã«ãªã‚‹ã“ã¨ã£ã¦ãªã„ã—ã€
ã¿ãªã•ã‚“ãã†ãªã‚“ã˜ã‚ƒãªã„ã§ã—ã‚‡ã†ã‹ã€‚

æ–‡æ³•ã§ã¯ç‰¹ã«

* OCamlã®æ§‹é€ æ¯”è¼ƒ`=`ãŒReasonã§ã¯`==`
* OCamlã®ãƒã‚¤ãƒ³ã‚¿æ¯”è¼ƒ`==`ãŒReasonã§ã¯`===`

ã«ãªã£ã¦ã„ã‚‹ã®ã‚’è¦‹ãŸã¨ã“ã‚ã§ç§ã«ã¯Reasonã¯èª­ã‚ãªã„æ›¸ã‘ãªã„ãªã¨åˆ¤æ–­ã—ã¾ã—ãŸã€‚
ã²ã£ã‹ã‘å•é¡Œã‹ã‚ˆã€‚
JavaScriptã«ã¯`==`ã¨`===`ãŒã‚ã‚‹ã‹ã‚‰ã€ã¿ãŸã„ã§ã™ã‘ã©ã€
Reasonã®`==`ã¨`===`ã¯OCamlã®`=`ã¨`==`ã®æ„å‘³ãªã‚“ã ã‹ã‚‰ã€
JavaScriptã®æ¼”ç®—å­ã¨ã‚‚æ„å‘³é•ã†ã‚“ã ã—ã‚„ã°ããªã„ã§ã™ã‹ã­ã€‚

ç§ã¯æ—¥é ƒStackOverflowã§OCamlã‚¿ã‚°ãŒã¤ã„ãŸæœªè§£ç­”è³ªå•ã«ã¯å‡ºæ¥ã‚‹ã ã‘è§£ç­”ã‚’
ã¤ã‘ã‚ˆã†ã¨æ€ã£ã¦ã„ã‚‹ã®ã§ã™ãŒã€
(ã ã‹ã‚‰ã‚ã‚Šã¨æ°—è»½ã«è³ªå•æ›¸ã„ã¦ãã ã•ã„ã€‚ç§ã˜ã‚ƒãªãã¦ã‚‚èª°ã‹ãŒç­”ãˆã¾ã™ã‹ã‚‰ã€‚)
ã“ã®ã¨ã“ã‚ã€è³ªå•ãŒReasonã§æ›¸ã„ã¦ã‚ã‚‹ã“ã¨ãŒå¢—ãˆã¦ãã¾ã—ãŸã€‚
å¤šåˆ†ã“ã†ã„ã†OCamlãƒ—ãƒ­ã‚°ãƒ©ãƒ ãªã‚“ã ã‚ã†ãªã¨ã¯æ€ã£ã¦ã‚‚ç¢ºä¿¡ãŒæŒã¦ãªã„ã®ã§åŠ©ã‘ã¦ã‚ã’ã‚‰ã‚Œãšã€
ã›ã£ã‹ãæ–°ã—ã„ãƒ¦ãƒ¼ã‚¶å…¥ã£ã¦ãã¦ã‚‚ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£çš„ã«åˆ†æ–­ã•ã‚Œã¦ã‚‹ã‚“ã˜ã‚ƒãªã„ã‹ã¨æ€ã„ã¾ã™ã€‚

# OCamlãƒ—ãƒ­ã‚°ãƒ©ãƒžã®ãŸã‚ã®æ–°æ–‡æ³•ã¯ï¼Ÿ

ã‚‚ã—ReasonãŒOCamlã®æ–‡æ³•ã®é†œã•ã‚’è§£æ±ºã—ã¦ã„ã‚‹ã¨ã—ã¦ã‚‚ã€
ã‚‚ã¨ã‚‚ã¨OCamlä½¿ã£ã¦ã„ã‚‹äººã«é­…åŠ›ãªã‹ã£ãŸã‚‰ã€ãã®äººãŸã¡ã«ã¯æ„å‘³ãŒãªã„ã€‚
Reasonã¯é–¢æ•°åž‹è¨€èªžã®æ–‡æ³•ãŒã©ã†ã‚‚ã¨ã„ã†äººã«å—ã‘ãŸã®ã§ã™ã‹ã‚‰ã€
ã˜ã‚ƒã‚é–¢æ•°åž‹è¨€èªžã®æ–‡æ³•ã«æ…£ã‚Œã¦ã„ã‚‹äººã®ãŸã‚ã®
æ–°ã—ã„OCamlã®æ–‡æ³•ãŒã‚ã£ã¦ã‚‚ã„ã„ã‚“ã˜ã‚ƒãªã„ã‹ã—ã‚‰ã‚“ã€ã¨æ€ã„ã¾ã—ã¦ã€
ä»Šå¹´ã¯æš‡ãªæ™‚ã«æ˜”ä½œã£ãŸã‚‚ã®ã‚’å¼•ã£å¼µã‚Šå‡ºã—ã¦éŠã‚“ã§ã„ã¾ã—ãŸã€‚
ã“ã®æ–‡ç« ã¯ãã‚Œã‚’ç´¹ä»‹ã—ã‚ˆã†ã¨æ€ã£ã¦æ›¸ã„ã¦ã„ã‚‹ã®ã§ã™ãŒã€
ã¾ã‚ãã‚Œã ã‘ç›´æŽ¥ç´¹ä»‹ã—ã¦ã‚‚ã¤ã¾ã‚‰ã‚“ã§ã™ã®ã§ã€å‰ç½®ããŒã©ã‚“ã©ã‚“é•·ããªã‚Šã¾ã™ã­ã€‚

## çµ‚ç«¯ãŒé–‰ã˜ãŸæ–‡æ³•è¦ç´ ã€é–‹ã„ãŸæ–‡æ³•è¦ç´ 

OCamlã«ã¯çµ‚ç«¯ã‚’æ›¸ã‹ãªãã¦è‰¯ã„ã€Œé–‹ã„ãŸæ–‡æ³•ã€ã¨ã€
çµ‚ç«¯ã‚’æ˜Žç¤ºã—ãªã‘ã‚Œã°ã„ã‘ãªã„ã€Œé–‰ã˜ãŸæ–‡æ³•ã€è¦ç´ ãŒã‚ã‚‹ã®ãŒ
ã‚ã‚Šã¨ç¾Žã—ããªã„ã€ã¨æ€ã„ã¾ã™ã€‚
(é–‹ã„ãŸæ–‡æ³•ã€é–‰ã˜ãŸæ–‡æ³•ã¨ã„ã†ã®ã¯ç§ãŒä»Šå‹æ‰‹ã«ä½œã£ãŸç”¨èªžã§ã™ã€‚
ãªã‚“ã‹é©åˆ‡ãªç”¨èªžãŒã‚ã£ãŸã‚‰æ•™ãˆã¦ãã ã•ã„ã€‚)

OCamlã§ã¯ã€å‘½ä»¤åž‹ã®åˆ¶å¾¡æ§‹æ–‡ã¯`for i=0 to 10 do .. done`ã‚„
`while .. do .. done`ãªã©ã®ã€Œé–‰ã˜ãŸã€æ–‡æ³•ã‚’æŽ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚
ã•ã‚‰ã«ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«é–¢ã™ã‚‹æ–‡æ³•`struct .. end`ã‚„`sig .. end`ã¯é–‰ã˜ã¦ã„ã¾ã™ã€‚

ä¸€æ–¹ã€é–¢æ•°åž‹è¨€èªžçš„ãªæ©Ÿèƒ½ã«é–¢ã™ã‚‹æ§‹æ–‡ã¯`fun ... -> e`, `let ... in ...`, ã‚„
`if .. then .. else ..`ãªã©ã€çµ‚ç«¯ã‚’æ›¸ã‹ãªãã¦ã‚ˆã„LCF MLç”±æ¥ã®ã€Œé–‹ã„ãŸã€æ–‡æ³•ã‚’æŽ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚

åž‹åˆ¶é™ã¯`(e : t)`ã¨æ›¸ãã€é–‰ã˜ãŸæ–‡æ³•ã§ã™ã€‚
æ‹¬å¼§ãªã®ã«ã€ã„ãã‚‰æ–‡é¢ã‹ã‚‰æ˜Žã‚‰ã‹ãªå ´åˆã§ã‚‚ã€çœç•¥ä¸å¯ã€‚
ãã®ä¸€æ–¹ã€`let`æŸç¸›ã®ã¨ã“ã‚ã§ã¯ `let p : t = e` ã¨æ‹¬å¼§ã‚’çœç•¥ã§ãã‚‹ç‰¹ä¾‹ãŒã‚ã‚Šã¾ã™:

```ocaml
  let (x, y) : int * int = (1,1);;
```

é–‰ã˜ã¦ã„ãŸã‚Šã€é–‹ã„ã¦ã„ãŸã‚Šã€çµ±ä¸€æ„ŸãŒç„¡ã„ã§ã™ã­ã€‚ã“ã®ã‚ãŸã‚Šã€é†œã„ã­ã€‚

é–‹ã„ãŸæ–‡æ³•ã¯LCF MLãŒå‚è€ƒã«ã—ãŸISWIMã‹ã‚‰ã®ã‚‚ã®ã§ã™ãŒã€ã“ã®æ–‡æ³•ã¯ã€
ã§ãã‚Œã°ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’è‡ªç„¶è¨€èªžã£ã½ãæ›¸ããŸã„ã€é–‰ã˜è¨˜å·ã‚’æ›¸ããŸããªã„ã®ã§ã™ã­ã€‚
ãã‚Œã«æ…£ã‚Œã‚‹ã¨ã€é–‰ã˜è¨˜å·å¿…é ˆã®æ–‡æ³•ã§ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ›¸ã„ã¦ã„ã¦
`end end .. end `ã‚„`)))))`ã‚„`fi; esac`ã¨ã‹æ›¸ã‹ãªã„ã¨ã„ã‘ãªããªã‚‹ã¨
é¢å€’ã ãªã‚ã¨æ„Ÿã˜ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
`for`ã‚„`while`ã¨ã‹ã€OCamlã«æ…£ã‚Œã¦ãã‚‹ã¨æ»…å¤šã«æ›¸ãã“ã¨ã¯ãªã„ã‚“ã§ã™ãŒã€
ã“ã„ã¤ã‚‰ã®æœ€å¾Œã«`done`ã‚’æ›¸ã‹ãªã„ã¨ã„ã‘ãªã„ã®ã¯æ ¼å¥½ãŒæ‚ªã„ã€‚
`for i = 0 to n do e` ã¨ã‹`while true do e`ã«ã™ã‚Œã°ã„ã„ã®ã«ã€‚

## é–‹ã„ãŸæ–‡æ³•ã®å•é¡Œ

ã§ã‚‚ã€é–‹ã„ãŸæ–‡æ³•ã«ã¯ä¸€ã¤å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚
é–‰ã˜ã‚‹è¨˜å·ãŒç„¡ã„åˆ†ã€å ´åˆã«ã‚ˆã£ã¦ã¯æ‹¬å¼§ã‚’æ›¸ã‹ãªã„ã¨ã„ã‘ãªã„å ´åˆãŒã‚ã‚‹ã®ã§ã™ã€‚
ä¾‹ãˆã°ã€

```ocaml
map (fun x -> x * 2) xs
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€`fun p -> e`ãŒ`fun p -> e end`ã®ã‚ˆã†ã«çµ‚ç«¯è¨˜å·ãŒå¿…è¦ãªæ–‡æ³•ã ã£ãŸå ´åˆã€

```ocaml
map fun x -> x *2 end xs
```

ã¨æ‹¬å¼§ãªã—ã§æ›¸ã‘ã‚‹ã®ã§ã™ã€‚ãˆï¼Ÿä½™è¨ˆæ°—æŒã¡æ‚ªã„ï¼Ÿã“ã®ä¾‹ã§ã¯ãã†ã§ã™ã­ã€‚

### å…¥ã‚Œå­ã‚±ãƒ¼ã‚¹

ã§ã¯æ¬¡ã®ä¾‹ã§ã¯ã©ã†ã§ã—ã‚‡ã†(OCamlã®Unixãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‹ã‚‰å¼•ç”¨ã€è‡ªæ˜Žãªæ•´å½¢ã‚ã‚Š):

```ocaml
let system cmd =
  match fork() with
  | 0 ->
      try
        execv "/bin/sh" [| "/bin/sh"; "-c"; cmd |]
      with
      | Error _ ->
          sys_exit 127
  | id -> snd (waitpid_non_intr id)
```

ã“ã‚Œã¯ã‚ˆãã‚ã‚‹`fork`+`exec`ã®ä¾‹ã§ã™ã€‚ã§ã‚‚é–“é•ã£ã¦ã„ã¾ã™ã€‚æœ¬å½“ã¯ã€

```ocaml
let system cmd =
  match fork() with
  | 0 ->
      begin try (* ðŸ« *)
        execv "/bin/sh" [| "/bin/sh"; "-c"; cmd |]
      with
      | Error _ ->
          sys_exit 127
      end (* ðŸ« *)
  | id -> snd (waitpid_non_intr id)
```

ã¨ã€ä¸­ã®`try .. with ..`ã‚’æ‹¬å¼§(ã“ã“ã§ã¯`begin`,`end`)ã§å›²ã¾ãªã„ã¨ã„ã‘ã¾ã›ã‚“ã€‚
ãã†ã—ãªã„ã¨æœ€å¾Œã®`| id -> ..`ã®ã‚±ãƒ¼ã‚¹ãŒ`try`ã®ä¾‹å¤–å‡¦ç†ã®éƒ¨åˆ†ã ã¨ãƒ‘ãƒ¼ã‚¹ã•ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚
ã“ã®ä¾‹ã§ã¯å¤–å´ã®ã‚±ãƒ¼ã‚¹ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã®åž‹(`int`)ã¨å†…å´ã®ã‚±ãƒ¼ã‚¹ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã®åž‹(`exn`)ãŒ
é•ã†ã®ã§åž‹ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã£ã¦æ°—ãŒä»˜ã‘ã¾ã™ãŒã€ä¸¡æ–¹ã®åž‹ãŒåŒã˜ã ã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãšã€
ã‚„ã£ã‹ã„ãªãƒã‚°ã«ãªã£ã¦ã—ã¾ã†å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

### `if-then-else`ã§ã®é€æ¬¡å®Ÿè¡Œ

`if-then`ã‚„`if-then-else`ã‚‚çµ‚ç«¯ãŒé–‹ã„ã¦ã„ã‚‹ã®ã§åˆå¿ƒè€…ã¯ãƒã‚°ã‚’ä½œã‚Šã‚„ã™ã„:

```ocaml
let f greeting =
  if greeting then
    prerr_endline "hello in heaven"
  else
    prerr_endline "see you";
    prerr_endline " in hell" 
;;
```

ã“ã‚Œã ã¨`f true`ãŒ`hello in heaven in hell`ã«ãªã£ã¡ã‚ƒã„ã¾ã™ã­ã€‚æœ¬å½“ã¯ã€

```ocaml
let f greeting =
  if greeting then
    prerr_endline "hello in heaven"
  else begin (* ðŸ« *)
    prerr_endline "see you";
    prerr_endline " in hell"
  end (* ðŸ« *)
;;
```

ã¨ã—ãªã‘ã‚Œã°ã„ã‘ã¾ã›ã‚“ã€‚

ã“ã‚Œã¯OCamlã®ä¸€ç•ªã®åˆå¿ƒè€…æ®ºã—ãƒã‚¤ãƒ³ãƒˆã§ã€StackOverflowã®OCamlã®è³ªå•ã®å¤§ä½“3%ãã‚‰ã„ã¯
ã‚±ãƒ¼ã‚¹ã‚„æ¡ä»¶åˆ†å²ã§ã®é–‹ã„ãŸæ–‡æ³•ã®ã¿ç†è§£ã«èµ·å› ã™ã‚‹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã‚„ã€
æ„å›³ã¨ç•°ãªã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å‹•ä½œã§ã™ã€‚

ã“ã®å•é¡Œã‚’é¿ã‘ã‚‹ã®ã¯ç°¡å˜ã§ã™ã€‚
ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’æ©Ÿæ¢°ã«ä»»ã›ã‚Œã°ã€å•é¡Œã®è¡Œã®ã¨ã“ã‚ã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆå¤‰åŒ–ã§ã€
äººé–“ã®æ„å›³ã¨æ©Ÿæ¢°ã®ç†è§£ãŒãšã‚Œã¦ã„ã‚‹ã“ã¨ãŒã™ãã«ç†è§£ã§ãã‚‹ã®ã§ã™ã€‚
ã‘ã‚Œã©ã‚‚ã€åˆå¿ƒè€…ã®äººã¯å¤§æŠµã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ„ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ã‚‚é›£ã—ã„äººé”ã€‚
ã¾ãš`vim`ã¨ã‹`emacs`ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã€ãã®ä½¿ã„æ–¹ã‹ã‚‰ã€ã¨ã‹å§‹ã‚ã‚‹ã¨ã€
ã“ã‚Œã¯ã‚‚ã†æ•°é€±é–“æˆ»ã£ã¦ã“ã‚Œã¾ã›ã‚“ã€‚

ãªã®ã§æ˜”ã€ã“ã†ã„ã†ã®ã‚’èª¿ã¹ã‚‹ãƒ„ãƒ¼ãƒ«ã‚’ä½œã‚Šã¾ã—ãŸ: 
https://bitbucket.org/camlspotter/ocaml-check-indent 
ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãŒãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ãƒ‘ãƒ¼ã‚¹çµæžœã¨é½Ÿé½¬ãŒã‚ã£ãŸã‚‰è­¦å‘Šã‚’ç™ºã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
ãŸã ã“ã‚Œã¯çµå±€`lint`ãªã®ã§ã€åˆå¿ƒè€…ã¯ä½¿ã‚ãªã„ã—ã€ãƒ—ãƒ­ã¯ä½¿ã‚ãªã„ã‚ˆã­ã€‚
ãã†ã„ã†è™šã—ã•ãŒã‚ã‚Šã¾ã™ã­ã€‚

### é–¢æ•°é©ç”¨ã¨äºŒé …æ¼”ç®—å­

é–¢æ•°é©ç”¨ã«ã‚‚åˆå¿ƒè€…ç½ ãŒã‚ã‚Šã¾ã™ã€‚
ã“ã‚Œã¯OCamlã«é™ã‚‰ãšé–¢æ•°é©ç”¨ã«æ‹¬å¼§ãŒã„ã‚‰ãªã„è¨€èªžå…¨ã¦ã«ã‚ã‚‹å•é¡Œã ã¨æ€ã†ã®ã§ã™ãŒã€
`f(a)`ã£ã¦æ›¸ã‹ãšã«`f a`ã£ã¦æ›¸ãã¾ã™ã‚ˆã­ã€‚
ã‚«ãƒªãƒ¼åŒ–ã•ã‚ŒãŸé«˜éšŽé–¢æ•°ã®é€£ç¶šé©ç”¨ã«ä¾¿åˆ©ã ã¨ã„ã†ã®ã§ã“ã†ãªã£ã¦ã„ã‚‹ã®ã§ã™ãŒã€
ã“ã‚Œã‚‚é–‰ã˜ãŸæ–‡æ³•ã‹ã‚‰é–‹ã„ãŸæ–‡æ³•ã«ãªã£ã¦ã„ã‚‹ã€‚ã“ã®æ–‡æ³•æ…£ã‚Œã¦ã„ãªã„ã¨ã€

```ocaml
fib 1+2
```

ã‚’

```ocaml
fib (1+2)
```

ã ã¨æ€ã£ã¦æ›¸ã„ã¦ã—ã¾ã„ã¾ã™ã€‚å››å‰‡æ¼”ç®—ã«é™ã‚‰ãšã€listã®consã§ã‚‚ã‚ˆãèµ·ã“ã‚Šã¾ã™
(ä¾‹: `f x::acc xs`ã‚’`f (x::acc) xs`ã®ã¤ã‚‚ã‚Šã§æ›¸ã„ã¦ã—ã¾ã†ã€‚)
ã“ã‚Œã‚‚StackOverflowã§é »å‡ºã™ã‚‹åˆå¿ƒè€…è³ªå•ã§ã™ã€‚
(StackOverflowä¸Šã§ã®ç‰¹å®šãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªžã®è³ªå•ã‚’ã¡ã‚ƒã‚“ã¨åˆ†é¡žã€ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹ã¨ã€
ã‹ãªã‚Šæ„å‘³ãŒã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚ä¸‰å›žç”Ÿã‚ãŸã‚Šã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦ã„ã‹ãŒã§ã—ã‚‡ã†ã€‚)

ã“ã‚Œã‚’é¿ã‘ã‚‹ç°¡å˜ãªæ–¹æ³•ã¯ã€

> äºŒé …æ¼”ç®—å­ã«ã¯å¿…ãšå‰å¾Œã«ã‚¹ãƒšãƒ¼ã‚¹ã‚’ä»˜ã‘ã‚‹

ã¨ã„ã†ã‚‚ã®ã§ã™ã€‚`fib 1 + 2`ã¨æ›¸ã‘ã°`fib (1 + 2)`ã¨ã¯è¦‹ãˆã«ãã„(ã¯ãšã )ã€‚
æ©Ÿæ¢°çš„ã«ã“ã‚Œã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã«ã¯`e1 e2 binop e3`ã¨æ©Ÿæ¢°ãŒãƒ‘ãƒ¼ã‚¹ã™ã‚‹å¼ã«ãŠã„ã¦ã€
`binop`ã®å‰å¾Œã«ã‚¹ãƒšãƒ¼ã‚¹ãŒã‚ã‚‹ã‹èª¿ã¹ã‚Œã°ã‚ˆã„ã¯ãšã§ã™ã€‚
ã“ã‚Œã‚’lintåŒ–ã—ãŸã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚lintã¯èª°ã‚‚ä½¿ã‚ãªã„ã‹ã‚‰ã§ã™ã€‚

ã“ã®ã‚ˆã†ã«ã€é–‰ã˜ã‚‹æ–‡æ³•ã‹ã‚‰å…¥ã£ã¦ããŸåˆå¿ƒè€…ã¯é–‹ã„ãŸæ–‡æ³•ã«æ…£ã‚Œã¦ã„ãªã„ã®ã§ã€
ã‚ˆãå¼•ã£ã‹ã‹ã£ã¦ãƒã‚°ã‚’å‡ºã—ã¾ã™ã€‚

é–‹ã„ãŸæ–‡æ³•ã®å•é¡Œã¯åˆå¿ƒè€…ã ã‘ã«é™ã‚Šã¾ã›ã‚“ã€‚æ…£ã‚ŒãŸäººã§ã‚‚æ¬¡ã®ã‚ˆã†ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®
æ›¸ãæ–¹ã‚’ã—ã¾ã™:

```ocaml
let system cmd =
  match fork() with
  | 0 ->
      try
        execv "/bin/sh" [| "/bin/sh"; "-c"; cmd |]
      with
      | Error _ ->
          sys_exit 127
      |â– 
```

ã“ã‚Œã¯ã€ä¸Šã®ä¾‹ã¨åŒã˜ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã„ã‚‹ãã®é€”ä¸­ã®æ®µéšŽã§ã€
`match`ã®ã‚±ãƒ¼ã‚¹ã‚’æ›¸ã“ã†ã¨æ€ã£ãŸãƒ—ãƒ­ã‚°ãƒ©ãƒžãŒã€ã“ã®ã¾ã¾ã‚±ãƒ¼ã‚¹ã‚’æ›¸ãã¨
`try`ã®ã‚‚ã®ã«ãªã£ã¦ã—ã¾ã†ã®ã«æ°—ã¥ã„ãŸçž¬é–“ã§ã™ã€‚
ã“ã“ã‹ã‚‰ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ­£ã—ããªãŠã™ãŸã‚ã«ã¯ã€

* ã‚«ãƒ¼ã‚½ãƒ«ã‚’`try`ã«ã¾ã§æŒã£ã¦ã„ã
* `begin`ã‚’è¶³ã™
* ã‚«ãƒ¼ã‚½ãƒ«ã‚’å…ƒã®ä½ç½®ã«æˆ»ã—ã¦`|`ã®å‰ã«`end`ã‚’æ›¸ã
* æ”¹è¡Œã¨ãƒªã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆ

ã—ãªã‘ã‚Œã°ã„ã‘ã¾ã›ã‚“ã€‚ã“ã‚Œã¯å†…éƒ¨ã®ã‚±ãƒ¼ã‚¹ã®ã‚³ãƒ¼ãƒ‰ãŒé•·ã„ã¨ã€
ã‚«ãƒ¼ã‚½ãƒ«ç§»å‹•ã«æ„å¤–ã¨æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ã€‚
ã‚³ãƒ¼ãƒ‰ã‚’ã®ã‚Šã«ã®ã£ã¦æ›¸ã„ã¦ã„ã‚‹ã¨ãã«ã¯ã‚¤ãƒ©ã‚¤ãƒ©ã—ã¾ã™ã­ã€‚
ã“ã‚Œã‚’é¿ã‘ã‚‹ã«ã¯

* å†…å´ã®`match`ã‚„`try`ã‚’æ›¸ãå‰ã‹ã‚‰ã“ã†ãªã‚‹ã“ã¨ã‚’äºˆè¦‹ã—ã¦`begin match/try`ã¨æ›¸ãã€‚
  (æ„è­˜ã™ã‚‹ã¨ã‚ã‚Šã¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ã‚³ãƒ„ã¯ã€æ„è­˜ã—ã¦ãã ã•ã„ã€‚)
* ä¸Šã®çŠ¶æ…‹ã‹ã‚‰è‡ªå‹•çš„ã«`begin`ã¨`end`ã‚’æŒ¿å…¥ã™ã‚‹ã‚«ãƒƒã‚³ã‚¤ã‚¤`Elisp`ã‹`Vimscript`ãªã©ã‚’æ›¸ã
* Twitterã§ãƒœãƒ¤ã„ã¦èª°ã‹ãŒãƒ„ãƒ¼ãƒ«ã‚’ä½œã£ã¦ãã‚Œã‚‹ã®ã‚’å¾…ã¤
* OCamlã‚’æ¨ã¦ã¦`match`ãŒé–‰ã˜ãŸæ–‡æ³•ã«ãªã£ã¦ã„ã‚‹Coqã‚’ä½¿ã†

ãªã©ã‚ã‚Šã¾ã™ãŒæ±ºå®šæ‰“ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

### ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«`let`

ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®`let p = e`ã‚‚åˆå¿ƒè€…æ®ºã—ã§ã™ã€‚
ã“ã‚Œã‚‚å®£è¨€ã®å¾ŒãŒé–‹ã„ã¦ã„ã‚‹ã®ã§ã€ãã®ã¾ã¾å¾Œã‚ã«åˆ¥ã®å®£è¨€ã§ã¯ãªã„å¼ã‚’æ›¸ã„ã¦ã—ã¾ã†ã¨
ãƒã‚°ã«ãªã‚Šã¾ã™:

```ocaml
let f x = match x with
  | 0 -> "0"
  | _ -> "non zero"

printf "%s" (f 0)
```

ã“ã‚Œã¯`;;`ã‚’ä½¿ã£ã¦`let`å®£è¨€ã®çµ‚äº†ã‚’æ˜Žç¤ºã™ã‚‹ã‹ã€

```ocaml
let f x = match x with
  | 0 -> "0"
  | _ -> "non zero"
;; (* ðŸ« *)

printf "%s" (f 0)
```

å¼ã‚’`let`å®£è¨€ã«ã—ãªã‘ã‚Œã°ã„ã‘ã¾ã›ã‚“:

```ocaml
let f x = match x with
  | 0 -> "0"
  | _ -> "non zero"

let () (* ðŸ« *) = printf "%s" (f 0)
```

ãƒ—ãƒ­ã¯å¾Œè€…ã‚’ä½¿ã£ã¦ã‚³ãƒ¼ãƒ‰ä¸­ã‹ã‚‰`;;`ã‚’æ¶ˆã™ã®ã‚’å¥½ã¿ã¾ã™ã€‚
(æ­£ç›´ã©ã£ã¡ã§ã‚‚ã„ã„ã§ã™ã€‚)

### ã‚¤ãƒ³ãƒ‡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ«ã®ç…©é›‘åŒ–

æœ€å¾Œã«ã€é–‹ã„ãŸæ–‡æ³•ã‚’ä½¿ã£ã¦ã„ã‚‹ã¨ã€è‡ªå‹•ã‚¤ãƒ³ãƒ‡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ«ã‚’æ›¸ãã®ãŒæ¯”è¼ƒçš„é¢å€’ã«ãªã‚Šã¾ã™ã€‚

çµ‚ç«¯ãŒæ˜Žç¤ºã•ã‚Œã¦ã„ã‚Œã°ã€çµ‚ç«¯è¨˜å·ã‚’è¦‹ãŸã‚‰ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ¬ãƒ™ãƒ«ã‚’1ä¸‹ã’ã‚Œã°ã„ã„ãªã€
ã¨ã‹ã€å¯¾å¿œã™ã‚‹é–‹å§‹è¨˜å·ã‚’æŽ¢ã—ã¦ã€ãã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ¬ãƒ™ãƒ«ã«æˆ»ã›ã°ã„ã„ãªã€
ã¨ã‚ã‹ã‚‹ã‚‚ã®ã§ã™ãŒã€æ˜Žç¤ºã•ã‚Œã¦ã„ãªã„æ–‡æ³•ã§ã¯ã‚ˆã‚Šè¤‡é›‘ã«ãªã‚Šã¾ã™ã€‚ä¾‹ãˆã°

```ocaml
let f x = match x with
  | 0 -> "0"
  | _ -> "non zero"

â– 
```

ã“ã“ã§ã€ã‚«ãƒ¼ã‚½ãƒ«ã®ã‚ã‚‹è¡Œã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã¯ã“ã®æ™‚ç‚¹ã§ã¯ã‚ã‹ã‚‰ãªã„ã€‚
æ¬¡ã«æ¥ã‚‹ãƒˆãƒ¼ã‚¯ãƒ³ã§æ±ºã¾ã‚Šã¾ã™:

* `let`ã‚„`type`ãªã©ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒæ¥ã‚Œã°ã€æ–°ã—ã„ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«å®£è¨€ã€‚ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã¯0char
* `;;`ãŒæ¥ãŸã‚‰ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«å®£è¨€ã®çµ‚ã‚ã‚Šã€‚ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã¯ã‚„ã¯ã‚Š0char
* `|` ãŒæ¥ã‚Œã°æ–°ã—ã„ã‚±ãƒ¼ã‚¹ã€‚ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã¯2chars
* ãã‚Œä»¥å¤–ã¯`"non zero"`ã«ç¶šãå¼ã€‚ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã¯9chars

ã¨å¤§ä½“å››é€šã‚Šã«åˆ¥ã‚Œã¾ã™ã€‚

OCamlã«ã¯æ˜”ã‹ã‚‰Emacsã®ãŸã‚ã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ¢ãƒ¼ãƒ‰ã¨ã—ã¦ocaml-modeã¨tuareg-modeã¨ã„ã†ã®ãŒ
ã‚ã‚Šã¾ã—ãŸã€‚tuareg-modeã®æ–¹ãŒå½“æ™‚ã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚¹ã‚¿ã‚¤ãƒ«ã«å¯¾å¿œã—ã¦ã„ãŸã®ã§ã‚ã‚Šã¨ã¿ã‚“ãª
ä½¿ã£ã¦ã„ãŸã®ã§ã™ãŒã€OCamlã«ã„ãã¤ã‹æ–°ã—ã„æ–‡æ³•è¦ç´ ãŒä»˜ã‘åŠ ã‚ã‚‹ã«å¾“ã£ã¦ã€
ã ã‚“ã ã‚“ã‚³ãƒ¼ãƒ‰ãŒè¤‡é›‘ã«ãªã‚Šã€èª°ã‚‚ãƒ¡ãƒ³ãƒ†å‡ºæ¥ãªã„(OCamlãƒ—ãƒ­ã‚°ãƒ©ãƒžã¯è™šå¼±ãªã®ã§
Elispã¯æ›¸ã‘ã‚‹ãŒä»–äººã®æ›¸ã„ãŸè¤‡é›‘ãªElispã‚’è¦‹ã‚‹ã¨æ­»ã¬)çŠ¶æ…‹ã«ãªã‚Šã¾ã—ãŸã€‚
ãã‚“ãªæ™‚ã«SMIE(Simply Minded Indentation Engine)ã¨ã„ã†ã®ãŒEmacsã«å‡ºã¦ãã¦ã€
tuareg-modeã‚’ã“ã®SMIEã§å®Ÿè£…ã—ãŸã‚‚ã®ãŒã§ãã¾ã—ãŸã€‚
ã“ã‚Œã‚’ã¿ãªã•ã‚“ä½¿ã„å§‹ã‚ãŸã®ã§ã™ãŒã€ã“ã‚ŒãŒä»¥å‰ã¨å…¨ãã®éžäº’æ›ã§ã€
ææ¡ˆã—ã¦ãã‚‹ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãŒåˆã‚ãªã„äººã«ã¯å¾¹åº•ã—ã¦åˆã‚ãªã‹ã£ãŸã®ã§ã™ã€‚
ã“ã‚Œã‚’æ‰‹ç›´ã—ã—ã‚ˆã†ã¨æ€ã£ã¦ã‚½ãƒ¼ã‚¹ã‚’è¦‹ã¦ã‚‚ã€ã“ã‚Œã®ã©ã“ãŒSimply Mindedã‚„ã­ã‚“ã¨ã„ã†çŠ¶æ…‹ã€‚
çµ‚ç«¯ãŒé–‹ã„ã¦ã„ã‚‹ã®ãŒæ™®é€šã®OCamlã®æ–‡æ³•ã«ã¯Operator precedence grammarã‚’
ä½¿ã£ãŸSMIEã¯é–“é•ã£ã¦ã„ãŸã®ã§ã¯ãªã„ã‹ã¨æ€ã„ã¾ã™ã€‚

ç§ã¯é•·ã„é–“æˆ‘æ…¢ã—ã¦å¤ã„tuareg-modeã‚’ä½¿ã£ã¦ã„ã¾ã—ãŸãŒã€æˆ‘æ…¢ã§ããªããªã£ã¦
`ocaml-indent`ã¨ã„ã†ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆç”¨å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ã‚’ä½œã‚Šã¾ã—ãŸã€‚
ç¾åœ¨ã§ã¯åŒã˜ã‚ˆã†ãª`ocp-indent`ãŒæ™®åŠã—ãŸãŠã‹ã’ã§ã€OCamlã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆå•é¡Œã¯
ã»ã¼è§£æ¶ˆã•ã‚Œã¾ã—ãŸãŒã€å½“æ™‚ã¯è‡ªå‹•ã§ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚‚å‡ºæ¥ãªã„ã®ãªã‚‰
è‡ªå‹•ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆæ¨ã¦ã¦ã€ãã®ä»£ã‚ã‚Šã«ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«æŽ¡ç”¨ã—ãŸã‚‰ã„ã„ã‚“ã¡ã‚ƒã†ã‹ã¨ã‹ã¾ã§
æ€ã£ã¦ã„ãŸã‚‚ã®ã§ã™ã€‚(ãã—ã¦ã“ã®åŽŸç¨¿ã«ã¤ãªãŒã‚‹ã‚ã‘ã§ã™ã‘ã‚Œã©ã‚‚)

## é–‰ã˜ãŸæ–‡æ³•ã®å•é¡Œ

Coqã®`match`ã®ã‚ˆã†ã«ã€é–‰ã˜ãŸæ–‡æ³•ã§ã¯ã“ã®ã‚ˆã†ãªå•é¡Œã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
ä¸€æ–¹ã€é–‰ã˜ãŸæ–‡æ³•ã®å•é¡Œã¯ã‚¿ã‚¤ãƒ—æ•°ãŒå¤šããªã£ã¦ã‚¦ã‚¶ããªã‚‹ã€ãŸã ãã‚Œã ã‘ã§ã™ã€‚

ãŸã ã€ã‚¦ã‚¶ã„ã€ã¨ã„ã†ã®ã¯äººé–“ã®æ ¹æœ¬ã®æ„Ÿæƒ…ãªã®ã§ã€è»½è¦–ã—ã¦ã¯ã„ã‘ãªã„ã€‚
æ”¾ç½®ã™ã‚‹ã¨ã€ã€ŒEnd hellã¯ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚·ã‚°ãƒŠãƒ«ã€ã ã¨ã‹ã€
ã€Œæ‹¬å¼§ã«åŸ‹æ²¡ã™ã‚‹å¿«æ¥½ã€ã¨ã‹ç¾çŠ¶è‚¯å®šã«èµ°ã‚Š(ãã‚Œä»¥ä¸Šã„ã‘ãªã„ã€‚

# ã˜ã‚ƒã‚OCamlã®é–‹ã„ãŸæ–‡æ³•ã©ã†ã™ã‚‹ã®

ã“ã®OCamlã®é–‹ã„ãŸæ–‡æ³•ã‚’ä¸€éƒ¨ã§ã‚‚ã©ã†ã«ã‹ã—ãŸã„ã¨æ€ã„ã¾ã™ãŒã€
ãã®å‰ã«æ—¢å­˜ç ”ç©¶ã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

## æ—¢å­˜ç ”ç©¶: CamlP4

å®Ÿã¯OCamlã®æ–‡æ³•ã‚’å¤‰ãˆãŸã‚‚ã®ã¯ã‚‚ã†ä¸€ã¤ã‚ã‚‹ã®ã§ã™ã€‚
CamlP4ã®Revised syntaxã¨è¨€ã†ã‚‚ã®ãŒã€‚
ãŒã€ã“ã‚Œã¯å®Ÿã«ä½¿ã„ã«ãã„ã€‚ãŸã¨ãˆã°ã€ã“ã®è¦‹æ…£ã‚ŒãŸOCamlãƒ—ãƒ­ã‚°ãƒ©ãƒ 

```ocaml
let rec fold_left f accu l =
  match l with
    [] -> accu
  | a::l -> fold_left f (f accu a) l
```

ãŒRevised syntaxã§ã¯

```
value rec fold_left f accu l =
  match l with
  [ [] -> accu
  | [ a :: l ] -> fold_left f (f accu a) l
  ]
;
```

ã“ã†ãªã‚Šã¾ã™ã€‚ä½•ã ã“ã‚Šã‚ƒã€‚ä½™åˆ†ã«ã¤ã„ãŸ`[`ã¨`]`ã§ã™ãŒã€Haskellã®çœç•¥å¯èƒ½ãª`{`ã¨`}`ã®è¨˜å·ãŒå¤‰ã‚ã£ã¦çœç•¥ä¸å¯ã«ãªã£ãŸã‚‚ã®ã¨æ€ãˆã°å¤§ä½“ã‚ã£ã¦ã„ã¾ã™ã€‚ã•ã‚‰ã«å„å®£è¨€ã®æœ€å¾Œã¯`;`ãŒå¿…é ˆã§ã™ã€‚ç°¡å˜ã«è¨€ã†ã¨ã€OCamlã®é–‹ã„ãŸæ–‡æ³•ã‚’ã‹ãªã‚Šé–‰ã˜ã¦ãã¦ã„ã¾ã™ã€‚ãŒã€ç„¡é§„ã«äºˆç´„èªžã‚’å¤‰ãˆãŸã‚Šã—ã¦ã„ã‚‹ã®ã§ã€ä½¿ã„ã«ãã„ã‚“ã§ã™ã€‚
ã“ã®Revised syntaxãŒé¢å€’ã ã£ãŸã¨ã„ã†é»’æ­´å²ã‚’è¦šãˆã¦ã„ã‚‹äººã¯ã€
OCamlã®æ–°ã—ã„æ–‡æ³•ã‚’ä½œã‚‹ã®ã«èºŠèº‡ã—ã¾ã™ã€‚

Revised syntaxã¯æ™®æ®µä½¿ã„ã¨ã—ã¦ä½¿ã„ã‚„ã™ã„OCamlã®æ–‡æ³•ã‚’æä¾›ã™ã‚‹ã®ãŒç›®çš„ã§ã¯ãªãã€OCamlã®ASTã‚’æ“ä½œã™ã‚‹ãŸã‚ã®DSLã¨ã—ã¦ä½œã‚‰ã‚ŒãŸã‚‚ã®ã§ã€æ–‡æ³•è¦ç´ ã®å¤šãã‚’é–‰ã˜ã‚‹ã“ã¨ã§quasiquoteã‚’ä½¿ã„ã‚„ã™ããªã‚‹åŠ¹æžœãŒã‚ã‚Šã¾ã™ã€‚OCamlã®æ™®é€šã®æ–‡æ³•ã§ã¯ã†ã¾ãæ›¸ã‘ãªã„ã‚¯ã‚©ãƒ¼ãƒˆãŒRevisedã ã¨æ›¸ã‘ãŸã¯ãšã€‚ã§ã‚‚ã ã‹ã‚‰ã£ã¦ãªã‚“ã§ã“ã‚“ãªæ–‡æ³•ã‚’è¦šãˆãªãã‚ƒã„ã‘ãªã„ã®ã€ã¨ã„ã†ã“ã¨ã§ã€CamlP4é–¢é€£ä»¥å¤–ã§ã¯å…¨ãä½¿ã‚ã‚Œãšã«çµ‚ã‚ã‚Šã¾ã—ãŸã€‚

## æ—¢å­˜ç ”ç©¶: F#

OCamlæ–‡æ³•ã®æ”¹å¤‰ã¨ã—ã¦ã‚‚ã†ä¸€ã¤ã‚ã‚Šã¾ã—ãŸã€‚ã§ã‚‚ã“ã‚Œã¯ã€OCamlã®å¤–ã«ã€‚
F# ã® "lightweight syntax" ã§ã™ã€‚
ã“ã®æ–‡æ³•ã¯OCamlã®æ–‡æ³•ã«ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ã‚’å…¥ã‚ŒãŸã‚‚ã®ã§ã€ãã®çµæžœã€
`;`ã‚„çµ‚ç«¯è¨˜å·ãŒå¤§å¹…ã«çœç•¥ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã‚‚ã®ã§ã™ã€‚

ä¾‹ãˆã°F#ã®æ–‡æ³•ã ã¨ã€æ¬¡ã®(OCaml)ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯æ­£ã—ã„æ„å‘³ã«ãªã‚Šã¾ã™:

```ocaml
let system cmd =
  match fork() with
  | 0 ->
      try
        execv "/bin/sh" [| "/bin/sh"; "-c"; cmd |]
      with
      | Error _ ->
          sys_exit 127
  | id -> snd (waitpid_non_intr id)
```

ã“ã‚Œã¯ã‚ã‚Šã¨ã„ã„ã‚“ã˜ã‚ƒãªã„ã‹ã¨æ€ã„ã¾ã™ã€‚

ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ã®ãŠã‹ã’ã§ã€OCamlã§ã¯`;;`ãŒå¿…è¦ãªã‚±ãƒ¼ã‚¹ã§ã‚‚`;;`ã‚’çœç•¥ã§ãã¾ã™:

```F#
let f x = match x with
  | 0 -> "0"
  | _ -> "non zero"

printfn "%s" (f 0)
```

OCamlã ã¨`printfn`ã®å‰ã«`;;`ã‚’å…¥ã‚Œãªã„ã¨ã€å‰ã®ç¶šãã ã¨æ€ã‚ã‚Œã¾ã™ã€‚

F#ã§ã¯ãƒªã‚¹ãƒˆã®æ”¹è¡ŒãŒã‚ã‚Œã°ã€åŒºåˆ‡ã‚Šã®`;`ã§ã•ãˆçœç•¥ã§ãã¾ã™:

```F#
printfn "%A" [ 1
               2
               3
             ]
```

ãˆãˆã¨ã€ã“ã‚Œã¯ã‚ã‚Šã¨ç§ã«ã¯æ°—æŒã¡æ‚ªã„ã®ã§ã™ãŒ...ä»–ã®`;`ãŒçœç•¥ã§ãã‚‹ãªã‚‰
ãƒªã‚¹ãƒˆã®åŒºåˆ‡ã‚Šã‚‚çœç•¥ã§ãã¦ã—ã‹ã‚‹ã¹ãã ã‚ã†ã€ã¨ã„ã†ã“ã¨ã§ã—ã‚‡ã†ã‹ã€‚
(ã˜ã‚ƒã‚ãªã‚“ã§`match`ã¨ã‹ã®ã‚±ãƒ¼ã‚¹åŒºåˆ‡ã‚Š`|`ã¯çœç•¥å¯èƒ½ã«ã—ãªã„ã‚“ã ã‚ã†...
æ™®é€šã«ã§ãã‚‹ã¨æ€ã†ã‚“ã ã‘ã©ã€‚)

ãŸã ã—ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãŒãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®æ„å‘³ã‚’è¦å®šã™ã‚‹æ–‡æ³•ã§ã™ã‹ã‚‰æ³¨æ„ã—ãªã‘ã‚Œã°
ã„ã‘ãªã„ã¨ã“ã‚ã‚‚ã§ã¦ãã¾ã™ã€‚ä¾‹ãˆã°:

```F#
if false then printfn "a"; printfn "b"
```

ã¨

```F#
begin if false then printfn "a" end; printfn "b"
```

ã¯é•ã„ã¾ã™ã­ã€‚

ã“ã®ã‚ˆã†ã«ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ã‚’æŽ¡ç”¨ã™ã‚‹ã¨ã€
é–‹ã„ãŸæ–‡æ³•ã®è¦‹ãŸç›®ã®ã¾ã¾é–‹ã„ãŸæ–‡æ³•ã®å•é¡ŒãŒè§£æ±ºã§ãã¾ã™ã€‚

å®Ÿã¯ã€ã“ã®æ–‡æ³•ã€**è¦‹ãŸç›®é–‹ã„ã¦ã„ã‚‹ã‚“ã§ã™ãŒã€è‡³ã‚‹ã¨ã“ã‚é–‰ã˜ã¦ã„ã‚‹**ã‚“ã§ã™ã€‚
æ§‹æ–‡ã®å§‹ã‚ã¨çµ‚ã‚ã‚Šã¯ç›®ã«ã¯ç›®ç«‹ãŸãªã„ãŒã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã¨ã—ã¦æ˜Žç¤ºã•ã‚Œã¦ã„ã‚‹ã®ã§ã™ã­ã€‚

# ã¼ãã®ã‹ã‚“ãŒãˆãŸã•ã„ãã‚‡ã†ã®

## ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«å…¥ã‚Œã‚ˆã†

ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ã‚’æŽ¡ç”¨ã—ãªã„ã§é–‹ã„ãŸæ–‡æ³•ã®ã¾ã¾ã«ã—ã¦ã„ã‚‹ã¨
å‰è¿°ã®é€šã‚Šã®åˆå¿ƒè€…æ®ºã—ãŒã§ãã¦ã—ã¾ã„ã¾ã™ã€‚
ã ã‹ã‚‰ã¨ã„ã£ã¦é–‰ã˜ãŸæ–‡æ³•ã«ã™ã‚‹ã¨çµ‚äº†è¨˜å·ãŒç›®ç«‹ã¡ã™ãŽã¦æ…£ã‚Œã¦ã„ã‚‹äººã«ã¯ç›®ã«ç…©ã„ã€‚
ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ã«ã™ã‚‹ã¨ã€ã“ã®ï¼’ã¤ã®å•é¡ŒãŒè§£æ±ºã•ã‚Œã‚‹ã®ã§
ã‚ã‚Šã¨ã‚¤ã‚±ã¦ã„ã‚‹ã®ã§ã¯ãªã„ã‹ã¨ã“ã®é ƒæ€ã†ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

ã ã‹ã‚‰ç§ã®æå”±ã™ã‚‹OCamlæ–°æ–‡æ³•ã¯ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ã‚’å…¥ã‚Œã‚ˆã†!!ã¨æ±ºã‚ã¾ã—ãŸã€‚
(ã¨ã„ã†ã‹å‰ã«ãã†ã„ã†ã®ã‚’ã™ã§ã«éŠã³ã§æ›¸ã„ã¦ã„ãŸã®ã§ã€ãã‚Œã‚’ã‚µãƒ«ãƒ™ãƒ¼ã‚¸ã—ãŸã ã‘ã§ã™ã‘ã©)

ã‚‚ã¡ã‚ã‚“ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦ã„ã‚‹ã¨ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®è‡ªå‹•ç”Ÿæˆã™ã‚‹æ™‚ã«é¢å€’ã¨ã‹ã€
ã‚ã‚‹ã®ã§ã™ãŒã€ä»Šæ™‚ã€ä»–ã®è¨€èªžãªã‚‰ã¨ã‚‚ã‹ãã€
OCamlã§ã®ã‚³ãƒ¼ãƒ‰è‡ªå‹•ç”Ÿæˆã¯ASTãƒ¬ãƒ™ãƒ«ã§ã‚„ã‚‹ã‚‚ã®ã§ã™ã€‚
ã‚³ãƒ¼ãƒ‰ã‚’ãƒ†ã‚­ã‚¹ãƒˆãƒ¬ãƒ™ãƒ«ã§`printf`ã¨ã‹`^`ã§ã¤ãªãŽåˆã‚ã›ã¦ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã™ã‚‹æ™‚ä»£ã§ã¯ãªã„ã€‚
ã›ã‚ã¦quasiquoteã¨ã‹ã§ã‚„ã£ã¦æ¬²ã—ã„ã€‚

## å¾Œæ–¹äº’æ›æ€§ãŸã‚‚ã¨ã†

ãµã‚“ã˜ã‚ƒãƒ¼OCamlã«ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«å…¥ã‚Œã¾ã—ãŸã€çµ‚äº†ã‚ã§ãŸã—ã‚ã§ãŸã—ãƒ‘ãƒãƒ‘ãƒ
ã ã¨è‡³æ¥µç°¡å˜ã§ã„ã„ã‚“ã§ã™ãŒã€ã¾ã å›°ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ãã®ã¾ã¾å…¥ã‚Œã‚‹ã¨å‰ã®æ–‡æ³•ã¨éžäº’æ›ã«ãªã‚‹ã®ã§ã™ã­ã€‚

æ–°æ–‡æ³•ä½œã£ãŸã‚‰æ–°æ–‡æ³•ã§ã‚³ãƒ¼ãƒ‰æ›¸ããŸã‚ã®ç§»è¡Œã‚³ã‚¹ãƒˆãŒç„¡è¦–ã§ããªã„ã®ã§ã€
å®Œå…¨ä¸Šä½äº’æ›ã«ã—ã¦ãŠããŸã„ã®ã§ã™ã€‚

F#ã«ã¯ã€ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ãŒå…¥ã£ãŸlightweightã¨
OCamlã«ã‚ˆã‚Šã‚ˆãä¼¼ãŸã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’æ°—ã«ã—ãªã„verboseã®ï¼’ã¤ã®æ–‡æ³•ãƒ¢ãƒ¼ãƒ‰ãŒã‚ã£ã¦ã€
OCamlã®ã‚³ãƒ¼ãƒ‰ã§ã‚‚ç°¡å˜ãªã‚‚ã®ãªã‚‰verboseãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ãˆã°ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ãŒã€
ã“ã‚Œã‚‰ã‚’åŒæ™‚ã«æ··ãœã¦æ›¸ãã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚
(`#light`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’ä½¿ãˆã°åˆ‡ã‚Šæ›¿ãˆã‚‹ã“ã¨ã¯ã§ãã¾ã™ãŒã€
ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«å®£è¨€ä¸€ã¤ã®ä¸­ã«ï¼’ã¤ã®æ–‡æ³•ã‚’æ··ãœã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã‚ˆã­)

å§‹ã‚ã‹ã‚‰æ–°æ–‡æ³•ã§100%ã‚³ãƒ¼ãƒ‰æ›¸ã‘ã¨è¨€ã‚ã‚ŒãŸã‚‰å¤šåˆ†é¢å€’ãã•ãã¦ãƒ€ãƒ¡ã§ã™ã€‚
æ–°æ–‡æ³•ã‚’ä½œã‚ã†ã¨ã—ã¦ã„ã‚‹æœ¬äººã§ã•ãˆãã‚“ãªæ„Ÿã˜ãªã®ã§ã€èª°ã‚‚ä½¿ã£ã¦ãã‚Œãªã„ã¨æ€ã„ã¾ã™ã€‚
ã§ãã‚Œã°ã€æ™®æ®µã¯æ™®é€šã®æ–‡æ³•ã§æ›¸ãã‚“ã ã‘ã‚Œã©ã‚‚ã€`match`ã¨ã‹å¾Œã§`begin`..`end`
å…¥ã‚Œãªãã‚ƒã„ã‘ãªã„ã‹ã‚‰é¢å€’ãã•ããªã‚Šãã†ã ãªã‚ã€ã¨ã„ã†ã¨ã“ã‚ã ã‘ã€ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«
ä½¿ãˆã‚Œã°å¬‰ã—ã„ã€‚ã¨æ€ã†ã€‚å¤šåˆ†ã€‚

ãã“ã§å‚è€ƒã«ã—ãŸã®ãŒPythonã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«æ–¹å¼ã§ã™ã€‚
Pythonã§ã¯ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ã‚’ä½¿ã£ãŸã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã«å…¥ã‚‹æ™‚ã«`:`ã‚’ä½¿ã„ã¾ã™ã‚ˆã­ã€‚
ãã®çœŸä¼¼ã‚’ã—ã¦ã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®å¾Œã«`:`ãŒæ›¸ã„ã¦ã‚ã‚‹æ™‚ã ã‘ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ã‚’ä½¿ã†ã‚ˆã†ã«ã™ã‚Œã°ã€
ã‚ªãƒªã‚¸ãƒŠãƒ«æ–‡æ³•ã®ã‚³ãƒ¼ãƒ‰ã¨æ–°æ–‡æ³•ã®ã‚³ãƒ¼ãƒ‰ãŒæ··åœ¨ã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€

```ocaml
let system cmd =
  match fork() with
  | 0 ->
      try
        execv "/bin/sh" [| "/bin/sh"; "-c"; cmd |]
      with:      (* <= ã“ã®withã¯ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ« *)
      | Error _ ->
          sys_exit 127
  | id -> snd (waitpid_non_intr id)
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯`try`ã®`with:`ã«é–¢ã—ã¦ã ã‘ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ãŒå…¥ã£ã¦ã„ã¾ã™ã€‚
ã‚‚ã—ã€`with:`ãŒç¾ã‚ŒãŸã‚‰ã€ãã®ç›´å¾Œã«`begin`ã‚’æŒ¿å…¥ã—ã€ãã‚Œä»¥é™ã€
ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãŒ`with:`ã®ã‚ã‚‹è¡Œã‚ˆã‚Šã‚‚å·¦ã«ã„ã£ãŸã‚‰ã€
ãã®ç›´å‰ã«`end`ã‚’å…¥ã‚Œã¦ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¾ã™ã€‚
ã¤ã¾ã‚Šã€ä¸Šã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã¨åŒã˜ã«ãªã‚Šã¾ã™:

```ocaml
let system cmd =
  match fork() with
  | 0 ->
      try
        execv "/bin/sh" [| "/bin/sh"; "-c"; cmd |]
      with begin (* ðŸ« *)
      | Error _ ->
          sys_exit 127
      end (* ðŸ« *)
  | id -> snd (waitpid_non_intr id)
```

`begin`..`end`ã§åŒ…ã‚€ã®ã¯`try`ä»¥ä¸‹ã§ã¯ãªãã€`with`ä»¥ä¸‹ã«ãªã£ã¦ã„ã¾ã™ã€‚
OCamlã«ã¯`try .. with begin .. end`ã¨ã„ã†æ§‹æ–‡ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€
å¾Œæ–¹äº’æ›æ€§ã¯å´©ã‚Œãªã„ã®ã§ã€ã‚³ã‚½ã£ã¨å…¥ã‚Œã¦ã‚ã‚Šã¾ã™ã€‚
æ˜Žç¤ºçš„ã«æ›¸ã‘ãªã„Revised syntaxã®`[`ã¨`]`ã¨ã ã¨æ€ãˆã°è‰¯ã„ã§ã™ã€‚

æ¬¡ã®ä¾‹ã§ã¯`else:`ã®ã¨ã“ã‚ã«ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ãŒå…¥ã‚Šã¾ã™:

```ocaml
let f greeting =
  if greeting then
    prerr_endline "hello in heaven"
  else: (* ðŸ« *)
    prerr_endline "see you";
    prerr_endline " in hell" 
;;
```

ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã«å¾“ã£ã¦`begin`ã¨`end`ãŒæŒ¿å…¥ã•ã‚Œã¾ã™ã€‚

```ocaml
let f greeting =
  if greeting then
    prerr_endline "hello in heaven"
  else begin (* ðŸ« *)
    prerr_endline "see you";
    prerr_endline " in hell" 
  end (* ðŸ« *)
;;
```

## ã„ã‚ã‚“ãªè¨€èªžã«ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ã‚’å…¥ã‚Œã‚‰ã‚Œã‚‹

å®Ÿè£…ã§é¢ç™½ã„ã®ã¯ã€ã“ã®`begin`ã‚„`end`ã®è‡ªå‹•æŒ¿å…¥ã¯ãƒ‘ãƒ¼ã‚µãƒ¼éƒ¨ã§ã¯ãªãã¦ã€
å­—å¥è§£æžéƒ¨ã¨ãƒ‘ãƒ¼ã‚µãƒ¼éƒ¨ã®é–“ã«ã€ãƒˆãƒ¼ã‚¯ãƒ³åˆ—ã®å¤‰æ›ã¨ã—ã¦å®Ÿè£…ã§ãã‚‹ã“ã¨ã§ã™ã€‚
åŸºæœ¬çš„ã«ã¯:

* ç‰¹æ®Šãª`:`ä»˜ããƒˆãƒ¼ã‚¯ãƒ³ãŒæ¥ãŸã‚‰`:`ãªã—ã®ã‚‚ã®ã«å¤‰æ›´
* ç›´å¾Œã«`begin`ã‚’æŒ¿å…¥
* ç‰¹æ®Šãª`:`ä»˜ããƒˆãƒ¼ã‚¯ãƒ³ã®ã‚ã‚‹è¡Œã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ¬ãƒ™ãƒ«ã‚’ã‚¹ã‚¿ãƒƒã‚¯ã«ãƒ—ãƒƒã‚·ãƒ¥
* æ”¹è¡Œå¾Œã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ¬ãƒ™ãƒ«ã¨ã‚¹ã‚¿ãƒƒã‚¯å…ˆé ­ã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ¬ãƒ™ãƒ«ã‚’æ¯”è¼ƒã—ã€æ”¹è¡Œå¾Œã®ãƒ¬ãƒ™ãƒ«ãŒå°ã•ã‘ã‚Œã°ã€ã‚¹ã‚¿ãƒƒã‚¯ã‚’ãƒãƒƒãƒ—ã—ã€`end`ã‚’æŒ¿å…¥

ã“ã‚Œã ã‘ã§ã™ã€‚
`do:`ã«ã¯`begin`ã¯æŒ¿å…¥ã›ãšé–‰ã˜ã‚‹æ™‚ã¯`end`ã§ã¯ãªã`done`ã€ã ã¨ã‹ã€
ã‚±ãƒ¼ã‚¹åŒºåˆ‡ã‚Šã®`|`ã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã®æ‰±ã„ã¯ã¡ã‚‡ã£ã¨ç‰¹åˆ¥æ‰±ã„ã™ã‚‹ã¨ã‹ã€å°‘ã—ä¾‹å¤–ã¯ã‚ã‚Šã¾ã™ãŒã€
ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ã®å‡¦ç†ã¯OCamlã®æ–‡æ³•ã‚’ç†è§£ã™ã‚‹å¿…è¦ãŒå…¨ãã‚ã‚Šã¾ã›ã‚“ã€‚
ã§ã™ã®ã§ã€ã“ã®å‡¦ç†ã¯å­—å¥è§£æžã¨ãƒ‘ãƒ¼ã‚µãƒ¼ã‹ã‚‰ç‹¬ç«‹ã—ã¦å®Ÿè£…ã§ãã¾ã™ã—ã€
å¤šåˆ†åŒã˜ã‚ˆã†ã«ã—ã¦ã„ã‚ã‚“ãªè¨€èªžã«ã€å…ƒæ–‡æ³•ã¨ã®äº’æ›æ€§ã‚’ä¿ã£ãŸã¾ã¾ã€
ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ã‚’ç°¡å˜ã«å…¥ã‚Œã‚‹ã“ã¨ãŒã§ãã‚‹ã¯ãšã§ã™ã€‚

# OCamleopard ã§ã™ãéŠã¹ã¾ã™

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ­ãƒ¼ãƒ«

```shell
$ wget https://raw.github.com/ocaml/opam/master/shell/opam_installer.sh -O - | sh -s /usr/local/bin
$ opam update
$ opam switch 4.06.0
$ opam pin add leopard 'git://github.com/camlspotter/ocaml#4.06.0+leopard'
```

å‚è€ƒãƒªãƒ³ã‚¯:
* https://opam.ocaml.org/doc/Install.html

## ã‚ãã³ã‹ãŸ

```shell
$ leopard
# if true then:
    prerr_endline "hello"
    prerr_endline "world"
  ;;
```

```shell
$ cat > x.ml << EOF
if true then:
  prerr_endline "hello";
  prerr_endline "world"
;;
EOF
$ leopardc x.ml
$ ./a.out
```

## `xxx:` ã«å¯¾å¿œã—ã¦ã„ã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰

* `then:`,`else:`
* `function:`
* `match`ã¨`try`ã®`with:`
* `lazy:`
* `for`ã¨`while`ã®`do:`
* `struct:`ã¨`sig:`
* `object:`

### å¯¾å¿œã—ãªã„ã€ã¾ã å¯¾å¿œã—ã¦ã„ãªã„ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰

`begin`
: ã„ã‚„ä¸Šä½¿ãˆã°`begin:`ã„ã‚‰ãªã„ã§ã—ã‚‡

`assert` 
: ã‚„ã£ã¦ã‚‚ã„ã„ã§ã™ã­ã€‚ã‚ã¾ã‚Šä¾¿åˆ©ãã†ã§ã¯ãªã„ã‘ã©

`let`ã¨ã‹
: `in`ã‚„`;;`ãŒã„ã‚‰ãªããªã‚Šã¾ã™ãŒã€ãã®ãŸã‚ã«ã¯`let`ãŒtoplevelã‹ãã†ã§ãªã„ã‹åˆ¤æ–­ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆè§£æžãŒOCamlã®æ–‡æ³•ã‚’ã‚‚ã†å°‘ã—ã€ŒçŸ¥ã‚‹ã€å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚OCamlã®è‡ªå‹•ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’æ›¸ãã¨ãã«ã‚‚ã“ã‚ŒãŒå¿…è¦ã§é¢å€’ãã•ã„ã€‚`let module`ã¨ã‹ã‚‚ã‚ã‚Šã¾ã™ã­ã€‚ã¡ãªã¿ã«OCamlã¯`let module`,`let exception`ã‚’è¶³ã—ãŸã®ã«`let type`ãŒç„¡ã„ã€‚ãã—ã¦`let open M`ã¨ã„ã†è‹±èªžã¨ã—ã¦ãŠã‹ã—ã„ã‚‚ã®ãŒã‚ã‚‹ã€‚ã“ã®è¾ºã®æ‹¡å¼µæ–¹æ³•ãŒadhocã§å«Œã„ã€‚

`[@..]`ã¨ã‹`[%..]`ã¨ã‹
: è‰¯ã„æ–‡æ³•ãŒæ€ã„ã¤ãã¾ã›ã‚“ã€‚`[@:`ã«ã—ã¦`]`ãŒçœç•¥ã§ãã‚‹ã®ã¯å¥‡å¦™ã ã—ã€`@:`ã ã¨æ¼”ç®—å­ã¨ã‹ã¶ã£ã¦ã—ã¾ã„ã¾ã™ã€‚`:@`ã¨ã‹`:%`ã¨ã‹ã„ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã­ã€‚
